<?php

namespace MMH\SiteBundle\Repository;

/**
 * ArticleRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class ArticleRepository extends \Doctrine\ORM\EntityRepository
{

  public function getArticleWithImage()
  {
    return $this->createQueryBuilder('a')
    ->innerJoin('a.imagearticle', 'img')
    ->addSelect('img')
    ->setMaxResults(3)
    ->orderBy('a.dateCreation', 'DESC')
    ->getQuery()
    ->getResult();
  }

  public function getArticleWithAuthor($slug)
  {
    $qb =  $this->createQueryBuilder('a');
    $qb
      ->where ("a.slug = :slug")
      ->setParameter("slug",$slug)
      ;
      return $qb
    ->innerJoin('a.imagearticle', 'img')
    ->addSelect('img')
    ->leftJoin('a.user', 'use')
    ->addSelect('use')

    ->getQuery()
    ->getResult();
  }

}
